# 无常损失（Impermanent Loss）可视化

这个脚本用于可视化流动性提供者（LP）在 AMM（自动做市商）中的无常损失情况。

## 功能说明

脚本会生成两个图表：

1. **持币 vs 做LP 收益曲线**：对比直接持币（HODL）和提供流动性（LP）两种策略在不同价格下的资产总价值
2. **无常损失曲线**：展示随着 ETH 价格变化，LP 相对于持币策略的收益差异百分比

## 初始条件

- ETH 初始价格：$2000
- 初始 ETH 数量：5
- 初始 USDC 数量：$10000
- 价格分析范围：$1000 - $4000

## 核心概念

### 常数乘积公式（x * y = k）

在 AMM 中，流动性池遵循常数乘积公式：
- `k = eth_amount * usdc_amount`（常数）
- 当价格变化时，池中的 ETH 和 USDC 数量会重新平衡

### 无常损失计算

无常损失 = (LP价值 / 持币价值) - 1

当价格偏离初始价格时，LP 会遭受无常损失。

## 使用方法

```bash
python il.py
```

## 依赖库

- `numpy`：数值计算
- `matplotlib`：数据可视化

## 安装依赖

```bash
pip install numpy matplotlib
```

## 图表说明

### 第一张图：收益对比
- **绿色线**：持币价值 (HODL) - 直接持有 ETH 和 USDC 的总价值
- **红色线**：做LP价值 (AMM) - 在流动性池中的资产总价值

### 第二张图：无常损失
- **紫色线**：无常损失百分比，负值表示损失
- **红色点**：标记初始价格点

## 注意事项

- 无常损失只在价格偏离初始价格时发生
- 当价格回到初始价格时，无常损失为 0
- 如果价格大幅波动，无常损失可能相当显著
- 实际 LP 收益还需要考虑交易手续费等其他因素

