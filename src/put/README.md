# 期权防御策略量化分析器

## 📋 项目简介

这是一个专业的期权防御策略量化分析工具，基于不同期限的期权数据（60天、90天、180天），对防御性看跌策略进行全面的量化分析，包括直接买入、价差组合等策略的Delta、Theta、Vega、IV分析。

## 🎯 主要功能

### 1. 数据清洗与预处理
- 自动读取CSV格式的期权数据
- 数据清洗和异常值处理
- 计算期权中间价、隐含波动率等关键指标
- 自动推断标的价格

### 2. 期权指标计算
- **Moneyness**: 行权价/标的价格比值
- **时间价值**: 期权价格 - 内在价值
- **Vega/Theta比值**: 波动率敏感性/时间损耗比值
- **性价比评分**: 综合评估期权价值
- **防御性评分**: 基于Delta的防御效果评估

### 3. 策略分析
- **单买看跌期权**: 分析直接买入看跌期权的效果
- **看跌价差策略**: 分析Bear Put Spread组合策略
- **跨期限比较**: 对比60天、90天、180天不同期限的表现

### 4. 可视化分析
- **IV Smile曲线**: 隐含波动率微笑曲线对比
- **Vega/Theta比值图**: 波动率敏感性与时间损耗对比
- **性价比评分图**: 各期权性价比可视化
- **Delta分布图**: 防御性指标分布
- **策略对比图**: 不同策略效果对比
- **期限对比图**: 不同期限综合分析

### 5. 智能推荐
- 基于多维度指标的最优策略推荐
- 详细的文字分析报告
- 风险提示和投资建议

## 📁 文件结构

```
put/
├── put.py                    # 主程序文件
├── requirements.txt          # 依赖包列表
├── README.md                # 说明文档
├── data/                    # 数据文件夹
│   ├── BTC-26DEC25-export.csv    # 90天期权数据
│   ├── BTC-27MAR26-export.csv    # 180天期权数据
│   └── BTC-28NOV25-export.csv    # 60天期权数据
└── export/                  # 输出文件夹
    ├── options_analysis.png      # 可视化图表
    ├── options_analysis_summary.csv  # 分析结果汇总
    └── analysis_report.txt       # 文字分析报告
```

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 准备数据

将期权数据文件放在 `data/` 文件夹中，文件格式应包含以下字段：
- 产品: 期权代码
- 买价/卖价: 期权买卖价格
- 标记: 标记价格
- IV 报价/IV 询价: 隐含波动率
- Δ|增量: Delta值
- Theta: Theta值
- Vega: Vega值
- Gamma: Gamma值

### 3. 运行分析

```bash
python put.py
```

### 4. 查看结果

分析完成后，结果将保存在 `export/` 文件夹中：
- `options_analysis.png`: 可视化分析图表
- `options_analysis_summary.csv`: 策略分析汇总表
- `analysis_report.txt`: 详细文字分析报告

## 📊 分析指标说明

### 核心指标

1. **Delta**: 价格敏感性
   - 防御性目标: -0.3 到 -0.5
   - 表示标的价格变动1单位，期权价格变动Delta单位

2. **Theta**: 时间价值衰减
   - 绝对值越小越好
   - 表示每天时间价值损失

3. **Vega**: 波动率敏感性
   - 防御策略中希望较高
   - 表示隐含波动率变动1%，期权价格变动Vega单位

4. **Vega/Theta比值**: 关键性价比指标
   - 比值越高，波动率收益相对时间损耗越好
   - 是选择期权的重要参考指标

### 评分体系

- **性价比评分**: `Vega / |Theta| × (1 / IV)`
- **防御性评分**: 基于Delta在最佳防御区间的程度
- **综合评分**: 性价比(40%) + 防御性(30%) + IV优势(30%)

## 🎯 策略类型

### 1. 单买看跌期权 (Long Put)
- **适用场景**: 预期标的价格下跌
- **优势**: 简单直接，最大损失有限
- **劣势**: 时间价值损耗较大

### 2. 看跌价差策略 (Bear Put Spread)
- **适用场景**: 预期小幅下跌，降低净成本
- **优势**: 降低净成本，减少时间损耗
- **劣势**: 最大收益有限

## 📈 使用建议

### 1. 期限选择
- **60天**: 适合短期防御，时间损耗相对较小
- **90天**: 平衡时间损耗和流动性
- **180天**: 适合长期防御，但时间损耗较大

### 2. 行权价选择
- **ATM (At-The-Money)**: Delta接近-0.5，防御性最强
- **略OTM (Out-of-The-Money)**: 成本较低，Delta约-0.3到-0.4
- **避免深度ITM**: 成本高，时间价值少

### 3. 入场时机
- **IV低位**: 隐含波动率处于相对低位时入场
- **Vega/Theta比值高**: 选择波动率收益相对时间损耗更优的期权
- **Delta适中**: 在-0.3到-0.5之间获得最佳防御效果

## ⚠️ 风险提示

1. **时间价值衰减**: 期权存在时间价值损耗风险
2. **波动率风险**: 隐含波动率变化可能影响期权价格
3. **流动性风险**: 部分期权可能存在流动性不足问题
4. **市场风险**: 期权价格受多种因素影响，存在不确定性

## 🔧 自定义配置

### 修改标的价格
```python
analyzer = OptionsDefenseAnalyzer()
analyzer.run_analysis(spot_price=60000)  # 手动设置标的价格
```

### 调整评分权重
在 `calculate_metrics()` 方法中修改权重：
```python
df['composite_score'] = (
    df['cost_effectiveness'] * 0.4 +    # 性价比权重
    df['defense_score'] * 0.3 +         # 防御性权重
    (1 - df['iv_percentile']) * 0.3     # IV优势权重
)
```

## 📞 技术支持

如有问题或建议，请通过以下方式联系：
- 提交Issue到项目仓库
- 发送邮件至项目维护者

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

---

**免责声明**: 本工具仅供学习和研究使用，不构成投资建议。期权交易存在风险，请谨慎投资。
